<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analytic Methods for Estimation of Boreal Caribou Survival, Recruitment and Population Growth • bboutools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analytic Methods for Estimation of Boreal Caribou Survival, Recruitment and Population Growth">
<meta property="og:description" content="bboutools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bboutools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bbmethods.html">Analytic Methods for Estimation of Boreal Caribou Survival, Recruitment and Population Growth</a>
    </li>
    <li>
      <a href="../articles/bbtutorial.html">Getting Started with bboutools</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/poissonconsulting/bboutools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analytic Methods for Estimation of Boreal
Caribou Survival, Recruitment and Population Growth</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/poissonconsulting/bboutools/blob/HEAD/vignettes/bbmethods.Rmd" class="external-link"><code>vignettes/bbmethods.Rmd</code></a></small>
      <div class="hidden name"><code>bbmethods.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="bayesian-vs-frequentist-framework">Bayesian vs Frequentist Framework<a class="anchor" aria-label="anchor" href="#bayesian-vs-frequentist-framework"></a>
</h2>
<p>The frequentist (Maximum Likelihood) framework selects the parameter
values which if they were true would be most likely to give rise to the
data. It assumes that all possible survival and recruitment values are
equally likely to be true. The confidence intervals (CIs) are invalid
with small sample size.</p>
<p>The Bayesian framework selects parameter values which most likely to
be true given the data. It allows incorporation of biological knowledge.
The credible intervals (CIs) represent the actual uncertainty
irrespective of the sample size.</p>
<p>Most models can be fit in a Bayesian or frequentist framework.</p>
</div>
<div class="section level2">
<h2 id="fixed-vs-random-effects">Fixed vs Random Effects<a class="anchor" aria-label="anchor" href="#fixed-vs-random-effects"></a>
</h2>
<p>When a categorical variable is treated as a fixed effect each
parameter value is estimated in isolation. In contrast, when it is
treated as a random effect the parameter values are assumed to be drawn
from a common underlying distribution which allows the typical values to
be estimated and each parameter estimate to be influenced by the other
ones.</p>
<p>The use of random effects is especially beneficial when some
months/years have sparse or missing data. In the case of sparse data or
extreme values, estimates will tend to be pulled toward the mean (i.e.,
‘shrinkage’). For missing data, the estimate will be equal to the mean.
Shrinkage may not be desired if extreme values are likely to represent
the true value (e.g., numerous wolf attacks in one year). In this case,
a fixed effect model would yield better estimates.</p>
<p>Fixed and random effects can be used in Bayesian or frequentist
models.</p>
</div>
<div class="section level2">
<h2 id="maximum-likelihood-vs-posterior-probability">Maximum Likelihood vs Posterior Probability<a class="anchor" aria-label="anchor" href="#maximum-likelihood-vs-posterior-probability"></a>
</h2>
<p>The frequentist approach simply identifies the parameter values that
maximize the likelihood, i.e., have the greatest probability of having
produced the data if they were true. It does this by searching parameter
space for the combination of parameter values with the Maximum
Likelihood. Parameter estimates for random effects can be estimated
using the Laplace approximation (i.e., with software packages <a href="https://arxiv.org/pdf/1509.00660.pdf" class="external-link">TMB</a> or <a href="https://r-nimble.org/html_manual/cha-AD.html#how-to-use-laplace-approximation" class="external-link">Nimble</a>).
The CIs are calculated using the standard errors, assuming that the
likelihood is normally distributed. This approach has the advantage of
being fast.</p>
<p>The Bayesian approach multiplies the likelihood by the probability of
the parameter values being true based on prior knowledge to get the
posterior probability of the parameter values being true based on the
data. Bayesian methods repeatedly sample from the posterior probability
distributions using MCMC (Monte Carlo Markov Chain) methods. This
approach has the advantage of allowing derived parameters such as the
population growth rate to be accurately estimated from the primary
survival and recruitment parameters.</p>
</div>
<div class="section level2">
<h2 id="bboutools">bboutools<a class="anchor" aria-label="anchor" href="#bboutools"></a>
</h2>
<p><code>bboutools</code> provides the option to estimate parameter
values using a Maximum Likelihood or a fully Bayesian approach. Random
effects are used where appropriate by default. The Bayesian approach
also uses biologically reasonable informative priors by default.
<code>bboutools</code> provides relatively simple general models that
can be used to compare survival, recruitment and population growth
estimates across jurisdictions.</p>
<p>By default, the <code>bboutools</code> Bayesian method saves 1,000
MCMC samples from each of three chains (after discarding the first
halves). The number of samples saved can be adjusted with the
<code>niters</code> argument. With <code>niters</code> set, the user can
simply increment the thinning rate as required to achieve convergence.
This process is automated in the Shiny app.</p>
<div class="section level3">
<h3 id="survival-model">Survival Model<a class="anchor" aria-label="anchor" href="#survival-model"></a>
</h3>
<p>The survival model with annual random effect and trend is specified
below in a simplified form of the BUGS language for readability. The
same model code is used for both the Bayesian and frequentist
methods.</p>
<pre><code>b0 ~ Normal(4, 2)
bYear ~ Normal(0, 1)

sMonth ~  Normal(0, 2) T(0,)
for(i in 1:nMonth)  bMonth[i] ~ Normal(0, sMonth)

sAnnual ~ Exponential(1)
for(i in 1:nAnnual)  bAnnual[i] ~ Normal(0, sAnnual)

for(i in 1:nObs) {
  logit(eSurvival[i]) = b0 + bMonth[Month[i]] + bAnnual[Annual[i]] + bYear * Year[i]
  Mortalities[i] ~ Binomial(1 - eSurvival[i], StartTotal[i])
}</code></pre>
</div>
<div class="section level3">
<h3 id="recruitment-model">Recruitment Model<a class="anchor" aria-label="anchor" href="#recruitment-model"></a>
</h3>
<p>The recruitment model with annual random effect and year trend is
specified below in a simplified form of the BUGS language for
readability.</p>
<pre><code><span><span class="va">b0</span> <span class="op">~</span> <span class="fu">Normal</span><span class="op">(</span><span class="op">-</span><span class="fl">1.4</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">bYear</span> <span class="op">~</span> <span class="fu">Normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adult_female_proportion</span> <span class="op">~</span> <span class="fu">Beta</span><span class="op">(</span><span class="fl">65</span>, <span class="fl">35</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sAnnual</span> <span class="op">~</span>  <span class="fu">exponential</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nAnnual</span><span class="op">)</span>  <span class="va">bAnnual</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Normal</span><span class="op">(</span><span class="fl">0</span>, <span class="va">sAnnual</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nObs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">FemaleYearlings</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Binomial</span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">Yearlings</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">Cows</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Binomial</span><span class="op">(</span><span class="va">adult_female_proportion</span>, <span class="va">CowsBulls</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">OtherAdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Binomial</span><span class="op">(</span><span class="va">adult_female_proportion</span>, <span class="va">UnknownAdults</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">eRecruitment</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">bAnnual</span><span class="op">[</span><span class="va">Annual</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">bYear</span> <span class="op">*</span> <span class="va">Year</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">AdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">FemaleYearlings</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">Cows</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">OtherAdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">Calves</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Poisson</span><span class="op">(</span><span class="va">eRecruitment</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">AdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
<p>In the frequentist approach, demographic stochasticity is removed
from the model because it is not possible to estimate discrete latent
variables using Laplace approximation. This has a minimal effect on
estimates. The adjusted model with no demographic stochasticity is
specified below.</p>
<pre><code><span><span class="va">bYear</span> <span class="op">~</span> <span class="fu">Normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adult_female_proportion</span> <span class="op">~</span> <span class="fu">Beta</span><span class="op">(</span><span class="fl">65</span>, <span class="fl">35</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sAnnual</span> <span class="op">~</span>  <span class="fu">exponential</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nAnnual</span><span class="op">)</span>  <span class="va">bAnnual</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Normal</span><span class="op">(</span><span class="fl">0</span>, <span class="va">sAnnual</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nObs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Cows</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Binomial</span><span class="op">(</span><span class="va">adult_female_proportion</span>, <span class="va">CowsBulls</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">FemaleYearlings</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Yearlings</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">OtherAdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">adult_female_proportion</span> <span class="op">*</span> <span class="va">UnknownAdults</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">eRecruitment</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">bAnnual</span><span class="op">[</span><span class="va">Annual</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">bYear</span> <span class="op">*</span> <span class="va">Year</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">AdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">FemaleYearlings</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">Cows</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">OtherAdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">Calves</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu">Poisson</span><span class="op">(</span><span class="va">eRecruitment</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">AdultsFemales</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="bboufit-objects">
<code>bboufit</code> Objects<a class="anchor" aria-label="anchor" href="#bboufit-objects"></a>
</h3>
<p>The <code><a href="../reference/bb_fit_survival.html">bb_fit_survival()</a></code> and
<code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code> functions use a Bayesian approach and
return objects that inherit from class <code>bboufit</code>.</p>
<p>Objects of class <code>bboufit</code> have three elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>model</code> - the compiled Nimble model as created by
<code><a href="https://rdrr.io/pkg/nimble/man/nimbleModel.html" class="external-link">nimble::nimbleModel()</a></code>.<br>
</li>
<li>
<code>model_code</code> - the model code in text format.<br>
</li>
<li>
<code>samples</code> - the MCMC samples generated
from<code><a href="https://rdrr.io/pkg/nimble/man/runMCMC.html" class="external-link">nimble::runMCMC()</a></code> converted to an object of class
<code>mcmcr</code>.<br>
</li>
<li>
<code>data</code> - the survival or recruitment data provided.</li>
</ol>
<p>These are the raw materials for any further exploration or analysis.
For example, view trace and density plots with
<code>plot(fit$samples)</code>.</p>
<p>See <a href="https://github.com/poissonconsulting/mcmcr" class="external-link">mcmcr</a>
and <a href="https://github.com/poissonconsulting/mcmcderive" class="external-link">mcmcderive</a>
for working with <code>mcmcr</code> objects, or convert samples to an
object of class <code>mcmc.list</code>, e,g, with
<code><a href="https://rdrr.io/pkg/coda/man/mcmc.list.html" class="external-link">coda::as.mcmc.list</a></code> for working with the <a href="https://github.com/cran/coda" class="external-link">coda</a> R package.</p>
</div>
<div class="section level3">
<h3 id="bboufit_ml-objects">
<code>bboufit_ml</code> Objects<a class="anchor" aria-label="anchor" href="#bboufit_ml-objects"></a>
</h3>
<p>The <code><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml()</a></code> and
<code><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml()</a></code> functions use a Maximum Likelihood
approach and return objects that inherit from class
<code>bboufit_ml</code>.</p>
<p>Objects of class <code>bboufit_ml</code> have four elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>model</code> - the Nimble model as created by
<code><a href="https://rdrr.io/pkg/nimble/man/nimbleModel.html" class="external-link">nimble::nimbleModel()</a></code>.<br>
</li>
<li>
<code>model_code</code> - the model code in text format.<br>
</li>
<li>
<code>mle</code> - the Maximum Likelihood output as created by
model$findMLE().</li>
<li>
<code>summary</code> - the summary of the Maximum Likelihood output
as created by <code>model$summary(mle)</code>.<br>
</li>
<li>
<code>data</code> - the survival or recruitment data provided.</li>
</ol>
<p>See <a href="https://github.com/nimble-dev/nimble" class="external-link">nimble</a> for how
to work with nimble model objects and Maximum Likelihood output.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Seb Dalgarno, Joe Thorley, John Boulanger, Ayla Pearson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
