<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prior Selection and Influence • bboutools</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto_Condensed-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Playfair_Display-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prior Selection and Influence">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bboutools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/bboutools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/methods.html">Analytic Methods for Estimation of Boreal Caribou Survival, Recruitment and Population Growth</a></li>
    <li><a class="dropdown-item" href="../articles/priors.html">Prior Selection and Influence</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/poissonconsulting/bboutools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prior Selection and Influence</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/poissonconsulting/bboutools/blob/main/vignettes/articles/priors.Rmd" class="external-link"><code>vignettes/articles/priors.Rmd</code></a></small>
      <div class="d-none name"><code>priors.Rmd</code></div>
    </div>

    
    
<!-- # Copyright 2022-2023 Integrated Ecological Research and Poisson Consulting Ltd. -->
<!-- # Copyright 2024 Province of Alberta -->
<!-- # -->
<!-- # Licensed under the Apache License, Version 2.0 (the "License"); -->
<!-- # you may not use this file except in compliance with the License. -->
<!-- # You may obtain a copy of the License at -->
<!-- # -->
<!-- # http://www.apache.org/licenses/LICENSE-2.0 -->
<!-- # -->
<!-- # Unless required by applicable law or agreed to in writing, software -->
<!-- # distributed under the License is distributed on an "AS IS" BASIS, -->
<!-- # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. -->
<!-- # See the License for the specific language governing permissions and -->
<!-- # limitations under the License. -->
<p>A prior distribution represents the existing uncertainty in the value
of an unknown parameter. The influence of a prior on the posterior
distribution will decrease as the number of observations increases.
<code>bboutools</code> uses weakly informative priors by default <span class="citation">(Gelman, Simpson, and Betancourt 2017; McElreath
2016)</span>.</p>
<p>If the user is interested in fitting models without priors, see
<code><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml()</a></code> and
<code><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml()</a></code>, which have identical models but use a
frequentist approach (Maximum Likelihood) to parameter estimation.
Models fit with Maximum Likelihood are equivalent to Bayesian models
with completely uninformative priors <span class="citation">(McElreath
2016)</span>.</p>
<div class="section level3">
<h3 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h3>
<p>Given the full model, the expected survival probability for the <span class="math inline">i^{th}</span> year and <span class="math inline">j^{th}</span> month is <span class="math display">\text{logit}(Survival[i,j]) = b0 + bAnnual[i] +
bMonth[j] + bYear \cdot Year[i]</span> Where <span class="math inline">bAnnual</span> can be a fixed or random effect of
categorical year on the intercept on the log-odds scale and <span class="math inline">Year</span> is the scaled continuous year.</p>
<p>This model has the following default priors in
<code>bboutools</code></p>
<ul>
<li>Intercept (log-odds scale) <span class="math display">b0 \sim
Normal(3, sd = 10)</span>
</li>
<li>Year fixed effect <span class="math display">bAnnual[i] \sim
Normal(0, sd = 10)</span>
</li>
<li>Year random effect</li>
</ul>
<p><span class="math display">sAnnual \sim Exponential(1) \\
bAnnual \sim Normal(0, sd = sAnnual)</span></p>
<ul>
<li><p>Month random effect <span class="math display">sMonth \sim
Exponential(1)\\
bMonth \sim Normal(0, sd = sMonth)</span></p></li>
<li><p>Year continuous effect <span class="math display">bYear \sim
Normal(0, sd = 2)</span></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="recruitment">Recruitment<a class="anchor" aria-label="anchor" href="#recruitment"></a>
</h3>
<p>Given the full model, the expected recruitment (calves per adult
female) for the <span class="math inline">i^{th}</span> year is <span class="math display">logit(Recruitment[i]) = b0 + bAnnual[i] + bYear
\cdot Year[i]</span> where <span class="math inline">bAnnual</span> can
be a fixed or random effect of categorical year on the intercept on the
log scale and <span class="math inline">Year</span> is the scaled
continuous year.</p>
<p>The model has the following default priors in
<code>bboutools</code></p>
<ul>
<li><p>Intercept (log-odds scale) <span class="math display">b0 \sim
Normal(-1, sd = 5)</span></p></li>
<li><p>Categorical year fixed effect <span class="math display">bAnnual[i] \sim Normal(0, sd = 5)</span></p></li>
<li><p>Categorical year random effect <span class="math display">sAnnual
\sim Exponential(1)\\
bAnnual \sim Normal(0, sd = sAnnual)</span></p></li>
<li><p>Continuous year effect <span class="math display">bYear \sim
Normal(0, sd = 2)</span></p></li>
</ul>
<p>The recruitment model can also estimate the adult female proportion
from observed Cows and Bulls <span class="math display">Cows =
adult\_female\_proportion \cdot (Cows + Bulls)</span> Where the default
prior for <span class="math inline">adult\_female\_proportion</span> has
a mode of 65% <span class="math display">adult\_female\_proportion \sim
Beta(65, 35)</span></p>
</div>
<div class="section level3">
<h3 id="prior-selection-and-influence">Prior selection and influence<a class="anchor" aria-label="anchor" href="#prior-selection-and-influence"></a>
</h3>
<p>As an example of the influence of priors on parameter estimates, we
tighten the standard deviation for the fixed effect of categorical year
on the intercept of monthly survival probability. The equivalent maximum
likelihood model is also fit for comparison.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/poissonconsulting/bboutools" class="external-link">bboutools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbousurv_c.html" class="external-link">bbousurv_c</a></span></span>
<span></span>
<span><span class="co"># force model to fit fixed year effect, use default priors</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival.html">bb_fit_survival</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  min_random_year <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tighten prior on bAnnual by changing SD from default 10 to 1</span></span>
<span><span class="va">fit_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival.html">bb_fit_survival</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  min_random_year <span class="op">=</span> <span class="cn">Inf</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bAnnual_sd"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit maximum likelihood model for comparison</span></span>
<span><span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  min_random_year <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p>The Bayesian model with vague priors (default) has annual survival
estimates that closely match the Maximum Likelihood estimates, whereas
the Bayesian model with a tighter prior on the year fixed effect
standard deviation results in estimates that are pulled in toward the
mean. If this behaviour is desirable (i.e., to place less trust in
extreme estimates), a model with a year random effect can be fit.</p>
<p>As another example, the user might strongly believe (i.e., based on
literature or biological understanding) that the true adult female
proportion is 65%. We compare estimates from very informative,
informative (default) and vague priors on <span class="math inline">adult\_female\_proportion</span>, along with the
maximum likelihood estimates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_c.html" class="external-link">bbourecruit_c</a></span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_inf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"adult_female_proportion_alpha"</span> <span class="op">=</span> <span class="fl">650</span>,</span>
<span>    <span class="st">"adult_female_proportion_beta"</span> <span class="op">=</span> <span class="fl">350</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_vague</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"adult_female_proportion_alpha"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"adult_female_proportion_beta"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>As with the above example, the adult female proportion estimate for a
Bayesian model with vague priors closely matches the Maximum Likelihood
estimate, whereas the Bayesian model with informative prior gives less
weight to the data.</p>
<p>The <span class="math inline">adult\_female\_proportion</span> can
also simply be fixed. See <code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code> for
details.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gelman_prior_2017" class="csl-entry">
Gelman, Andrew, Daniel Simpson, and Michael Betancourt. 2017. <span>“The
<span>Prior</span> <span>Can</span> <span>Often</span> <span>Only</span>
<span>Be</span> <span>Understood</span> in the <span>Context</span> of
the <span>Likelihood</span>.”</span> <em>Entropy</em> 19 (10). <a href="https://doi.org/10.3390/e19100555" class="external-link">https://doi.org/10.3390/e19100555</a>.
</div>
<div id="ref-mcelreath_statistical_2016" class="csl-entry">
McElreath, Richard. 2016. <em>Statistical Rethinking: A
<span>Bayesian</span> Course with Examples in <span>R</span> and
<span>Stan</span></em>. Chapman &amp; <span>Hall</span>/<span>CRC</span>
Texts in Statistical Science Series 122. Boca Raton: CRC Press/Taylor
&amp; Francis Group.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.poissonconsulting.ca/author/seb-dalgarno/" class="external-link">Seb Dalgarno</a>, <a href="https://www.poissonconsulting.ca/author/joe-thorley/" class="external-link">Joe Thorley</a>, John Boulanger, <a href="https://www.poissonconsulting.ca/author/ayla-pearson/" class="external-link">Ayla Pearson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
