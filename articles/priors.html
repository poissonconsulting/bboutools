<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prior Selection and Influence â€¢ bboutools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prior Selection and Influence">
<meta property="og:description" content="bboutools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bboutools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/bboutools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/methods.html">Analytic Methods for Estimation of Boreal Caribou Survival, Recruitment and Population Growth</a>
    </li>
    <li>
      <a href="../articles/priors.html">Prior Selection and Influence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/poissonconsulting/bboutools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prior Selection and Influence</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/poissonconsulting/bboutools/blob/HEAD/vignettes/articles/priors.Rmd" class="external-link"><code>vignettes/articles/priors.Rmd</code></a></small>
      <div class="hidden name"><code>priors.Rmd</code></div>

    </div>

    
    
<!-- # Copyright 2022 Environment and Climate Change Canada -->
<!-- # Copyright 2023 Province of Alberta -->
<!-- # Copyright 2024 Province of Alberta -->
<!-- # -->
<!-- # Licensed under the Apache License, Version 2.0 (the "License"); -->
<!-- # you may not use this file except in compliance with the License. -->
<!-- # You may obtain a copy of the License at -->
<!-- # -->
<!-- # http://www.apache.org/licenses/LICENSE-2.0 -->
<!-- # -->
<!-- # Unless required by applicable law or agreed to in writing, software -->
<!-- # distributed under the License is distributed on an "AS IS" BASIS, -->
<!-- # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. -->
<!-- # See the License for the specific language governing permissions and -->
<!-- # limitations under the License. -->
<p>A prior distribution represents the existing uncertainty in the value
of an unknown parameter. The influence of a prior on the posterior
distribution will decrease as the number of observations increases.
<code>bboutools</code> uses weakly informative priors by default <span class="citation">[@gelman_prior_2017;
@mcelreath_statistical_2016]</span>.</p>
<p>If the user is interested in fitting models without priors, see
<code><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml()</a></code> and
<code><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml()</a></code>, which have identical models but use a
frequentist approach (Maximum Likelihood) to parameter estimation.
Models fit with Maximum Likelihood are equivalent to Bayesian models
with completely uninformative priors <span class="citation">[@mcelreath_statistical_2016]</span>.</p>
<div class="section level3">
<h3 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h3>
<p>Given the full model, the expected survival probability for the <span class="math inline">\(i^{th}\)</span> year and <span class="math inline">\(j^{th}\)</span> month is <span class="math display">\[\text{logit}(Survival[i,j]) = b0 + bAnnual[i] +
bMonth[j] + bYear \cdot Year[i]\]</span> Where <span class="math inline">\(bAnnual\)</span> can be a fixed or random effect
of categorical year on the intercept on the log-odds scale and <span class="math inline">\(Year\)</span> is the scaled continuous year.</p>
<p>This model has the following default priors in
<code>bboutools</code></p>
<ul>
<li>Intercept (log-odds scale) <span class="math display">\[b0 \sim
Normal(3, sd = 10)\]</span>
</li>
<li>Year fixed effect <span class="math display">\[bAnnual[i] \sim
Normal(0, sd = 10)\]</span>
</li>
<li>Year random effect</li>
</ul>
<p><span class="math display">\[sAnnual \sim Exponential(1) \\
bAnnual \sim Normal(0, sd = sAnnual)\]</span></p>
<ul>
<li><p>Month random effect <span class="math display">\[sMonth \sim
Exponential(1)\\
bMonth \sim Normal(0, sd = sMonth)\]</span></p></li>
<li><p>Year continuous effect <span class="math display">\[bYear \sim
Normal(0, sd = 2)\]</span></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="recruitment">Recruitment<a class="anchor" aria-label="anchor" href="#recruitment"></a>
</h3>
<p>Given the full model, the expected recruitment (calves per adult
female) for the <span class="math inline">\(i^{th}\)</span> year is
<span class="math display">\[logit(Recruitment[i]) = b0 + bAnnual[i] +
bYear \cdot Year[i]\]</span> where <span class="math inline">\(bAnnual\)</span> can be a fixed or random effect
of categorical year on the intercept on the log scale and <span class="math inline">\(Year\)</span> is the scaled continuous year.</p>
<p>The model has the following default priors in
<code>bboutools</code></p>
<ul>
<li><p>Intercept (log-odds scale) <span class="math display">\[b0 \sim
Normal(-1, sd = 5)\]</span></p></li>
<li><p>Categorical year fixed effect <span class="math display">\[bAnnual[i] \sim Normal(0, sd =
5)\]</span></p></li>
<li><p>Categorical year random effect <span class="math display">\[sAnnual \sim Exponential(1)\\
bAnnual \sim Normal(0, sd = sAnnual)\]</span></p></li>
<li><p>Continuous year effect <span class="math display">\[bYear \sim
Normal(0, sd = 2)\]</span></p></li>
</ul>
<p>The recruitment model can also estimate the adult female proportion
from observed Cows and Bulls <span class="math display">\[Cows =
adult\_female\_proportion \cdot (Cows + Bulls)\]</span> Where the
default prior for <span class="math inline">\(adult\_female\_proportion\)</span> has a mode of
65% <span class="math display">\[adult\_female\_proportion \sim Beta(65,
35)\]</span></p>
</div>
<div class="section level3">
<h3 id="prior-selection-and-influence">Prior selection and influence<a class="anchor" aria-label="anchor" href="#prior-selection-and-influence"></a>
</h3>
<p>As an example of the influence of priors on parameter estimates, we
tighten the standard deviation for the fixed effect of categorical year
on the intercept of monthly survival probability. The equivalent maximum
likelihood model is also fit for comparison.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/poissonconsulting/bboutools" class="external-link">bboutools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbousurv_c.html" class="external-link">bbousurv_c</a></span></span>
<span></span>
<span><span class="co"># force model to fit fixed year effect, use default priors</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival.html">bb_fit_survival</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>  min_random_year <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tighten prior on bAnnual by changing SD from default 10 to 1</span></span>
<span><span class="va">fit_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival.html">bb_fit_survival</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  min_random_year <span class="op">=</span> <span class="cn">Inf</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bAnnual_sd"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit maximum likelihood model for comparison</span></span>
<span><span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>  min_random_year <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<p>The Bayesian model with vague priors (default) has annual survival
estimates that closely match the Maximum Likelihood estimates, whereas
the Bayesian model with a tighter prior on the year fixed effect
standard deviation results in estimates that are pulled in toward the
mean. If this behaviour is desirable (i.e., to place less trust in
extreme estimates), a model with a year random effect can be fit.</p>
<p>As another example, the user might strongly believe (i.e., based on
literature or biological understanding) that the true adult female
proportion is 65%. We compare estimates from very informative,
informative (default) and vague priors on <span class="math inline">\(adult\_female\_proportion\)</span>, along with the
maximum likelihood estimates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_c.html" class="external-link">bbourecruit_c</a></span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_inf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"adult_female_proportion_alpha"</span> <span class="op">=</span> <span class="fl">650</span>,</span>
<span>    <span class="st">"adult_female_proportion_beta"</span> <span class="op">=</span> <span class="fl">350</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_vague</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"adult_female_proportion_alpha"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="st">"adult_female_proportion_beta"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>  adult_female_proportion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="priors_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>As with the above example, the adult female proportion estimate for a
Bayesian model with vague priors closely matches the Maximum Likelihood
estimate, whereas the Bayesian model with informative prior gives less
weight to the data.</p>
<p>The <span class="math inline">\(adult\_female\_proportion\)</span>
can also simply be fixed. See <code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code> for
details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Seb Dalgarno, Joe Thorley, John Boulanger, Ayla Pearson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
