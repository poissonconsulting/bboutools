<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with bboutools • bboutools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with bboutools">
<meta property="og:description" content="bboutools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bboutools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/bboutools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/methods.html">Analytic Methods for Estimation of Boreal Caribou Survival, Recruitment and Population Growth</a>
    </li>
    <li>
      <a href="../articles/priors.html">Prior Selection and Influence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/poissonconsulting/bboutools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with bboutools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/poissonconsulting/bboutools/blob/HEAD/vignettes/bboutools.Rmd" class="external-link"><code>vignettes/bboutools.Rmd</code></a></small>
      <div class="hidden name"><code>bboutools.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/poissonconsulting/bboutools" class="external-link">bboutools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/" class="external-link">bboudata</a></span><span class="op">)</span></span></code></pre></div>
<p><code>bboutools</code> is an R package to estimate Boreal Caribou
recruitment, survival and population growth. Functions are provided to
fit Bayesian or Maximum Likelihood (ML) models and generate and plot
predictions.</p>
<p>Under the hood, the <a href="https://r-nimble.org" class="external-link">Nimble</a> R
package is used to fit heirarchical Bayesian and Maximum Likelihood
models. Model templates in Nimble use BUGS-like syntax.</p>
<p>Several anonymized data sets are provided in a separate R package,
<code>bboudata</code>.</p>
<p>In order to use <code>bboutools</code> you need to install R (see
below) or use the Shiny <a href="https://github.com/poissonconsulting/bboushiny" class="external-link">app</a>.</p>
<div class="section level2">
<h2 id="philosophy">Philosophy<a class="anchor" aria-label="anchor" href="#philosophy"></a>
</h2>
<p><code>bboutools</code> is intended to be used in conjunction with <a href="https://www.tidyverse.org" class="external-link">tidyverse</a> packages such as
<code>readr</code>, <code>dplyr</code> to manipulate data and
<code>ggplot2</code> <span class="citation">(Wickham 2016)</span> to
plot data. As such, it endeavors to fulfill the tidyverse <a href="https://tidyverse.tidyverse.org/articles/manifesto.html" class="external-link">manifesto</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>In order to install R <span class="citation">(R Core Team
2023)</span> the appropriate binary for the users operating system
should be downloaded from <a href="https://cran.r-project.org" class="external-link">CRAN</a>
and then installed.</p>
<p>Once R is installed, the <code>bboutools</code> package can be
installed from GitHub by executing the following code at the R
console</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"poissonconsulting/bboutools"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>bboutools</code> package can then be loaded into the
current session using</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/poissonconsulting/bboutools" class="external-link">bboutools</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>To get additional information on a particular function just type
<code>?</code> followed by the name of the function at the R console.
For example <code><a href="../reference/bb_fit_recruitment.html">?bb_fit_recruitment</a></code> brings up the R
documentation for the <code>bboutools</code> recruitment model fit
function.</p>
<p>For more information on using R the reader is referred to <a href="https://r4ds.had.co.nz" class="external-link">R for Data Science</a> <span class="citation">(Wickham and Grolemund 2016)</span>.</p>
<p>If you discover a bug in <code>bboutools</code> please file an issue
with a <a href="https://reprex.tidyverse.org/articles/reprex-dos-and-donts.html" class="external-link">reprex</a>
(reproducible example) at <a href="https://github.com/poissonconsulting/bboutools/issues" class="external-link uri">https://github.com/poissonconsulting/bboutools/issues</a>.</p>
</div>
<div class="section level2">
<h2 id="providing-data">Providing Data<a class="anchor" aria-label="anchor" href="#providing-data"></a>
</h2>
<p>Once the <code>bboutools</code> package has been loaded, the next
task is to provide some data. An easy way to do this is to create a
comma separated file (<code>.csv</code>) with spreadsheet software.
Recruitment and survival data should be formatted as in the following
anonymized datasets and can be checked to confirm it is in the correct
format by using the <code>bboudata</code> functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recruitment data</span></span>
<span><span class="fu">bboudata</span><span class="fu">::</span><span class="fu"><a href="https://poissonconsulting.github.io/bboudata/reference/bbd_chk_data_recruitment.html" class="external-link">bbd_chk_data_recruitment</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_a.html" class="external-link">bbourecruit_a</a></span><span class="op">)</span></span>
<span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_a.html" class="external-link">bbourecruit_a</a></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 696 × 9</span></span></span>
<span><span class="co">#&gt;    PopulationName  Year Month   Day  Cows Bulls UnknownAdults Yearlings Calves</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A               <span style="text-decoration: underline;">1</span>990     3     9     1     1             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A               <span style="text-decoration: underline;">1</span>990     3     9     5     1             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A               <span style="text-decoration: underline;">1</span>990     3     9     4     1             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A               <span style="text-decoration: underline;">1</span>990     3     9     2     0             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A               <span style="text-decoration: underline;">1</span>990     3     9     6     0             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A               <span style="text-decoration: underline;">1</span>990     3     9     4     1             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A               <span style="text-decoration: underline;">1</span>990     3     9     5     0             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A               <span style="text-decoration: underline;">1</span>990     3     9     2     0             0         0      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A               <span style="text-decoration: underline;">1</span>990     3     9     3     2             0         0      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A               <span style="text-decoration: underline;">1</span>990     3     9     4     0             0         0      1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 686 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survival data</span></span>
<span><span class="fu">bboudata</span><span class="fu">::</span><span class="fu"><a href="https://poissonconsulting.github.io/bboudata/reference/bbd_chk_data_survival.html" class="external-link">bbd_chk_data_survival</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbousurv_a.html" class="external-link">bbousurv_a</a></span><span class="op">)</span></span>
<span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbousurv_a.html" class="external-link">bbousurv_a</a></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 364 × 6</span></span></span>
<span><span class="co">#&gt;    PopulationName  Year Month StartTotal MortalitiesCertain MortalitiesUncertain</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A               <span style="text-decoration: underline;">1</span>986     1          0                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A               <span style="text-decoration: underline;">1</span>986     2          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A               <span style="text-decoration: underline;">1</span>986     3          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A               <span style="text-decoration: underline;">1</span>986     4          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A               <span style="text-decoration: underline;">1</span>986     5          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A               <span style="text-decoration: underline;">1</span>986     6          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A               <span style="text-decoration: underline;">1</span>986     7          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A               <span style="text-decoration: underline;">1</span>986     8          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A               <span style="text-decoration: underline;">1</span>986     9          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A               <span style="text-decoration: underline;">1</span>986    10          8                  0                    0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 354 more rows</span></span></span></code></pre></div>
<p>All columns should be included and column names should not be
changed.</p>
<p>The <code>.csv</code> file can then be read into R using the
following</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"path/to/file.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="recruitment">Recruitment<a class="anchor" aria-label="anchor" href="#recruitment"></a>
</h2>
<p>The annual recruitment in boreal caribou population is typically
estimated from annual calf:cow ratios.</p>
<p><code>bboutools</code> fits a Binomial recruitment model to the
annual counts of calves, cows, yearlings, unknown adults and
potentially, bulls.</p>
<p>It is up to the user to ensure that the data are from surveys that
were conducted at the same time of year, when calf survival is expected
to be similar to adult survival.</p>
<div class="section level3">
<h3 id="fit-a-bayesian-model">Fit a Bayesian model<a class="anchor" aria-label="anchor" href="#fit-a-bayesian-model"></a>
</h3>
<p>The function <code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code> fits a Bayesian
recruitment model.</p>
<p>The start month of the biological year (i.e., ‘caribou year’) can be
set with the <code>year_start</code> argument. By default, the start
month is April. Data are aggregated by biological year (not calendar
year) prior to model fitting.</p>
<p>The adult female proportion can either be fixed or estimated from
counts of cows and bulls (i.e.,
<code>Cows ~ Binomial(adult_female_proportion, Cows + Bulls)</code>).</p>
<p>If the user provides a value to <code>adult_female_proportion</code>,
it is fixed. The default value is 0.65, which accounts for higher
mortality of males <span class="citation">(Smith 2004)</span>. If
<code>adult_female_proportion = NULL</code>, the adult female proportion
is estimated from the data (i.e.,
<code>Cows ~ Binomial(adult_female_proportion, Cows + Bulls)</code>). By
default, a biologically informative prior of <code>Beta(65,35)</code> is
used. This corresponds to an expected value of 65%.</p>
<p>The yearling female proportion can be set with
<code>yearling_female_proportion</code>. The default value is 0.5.</p>
<p>The model can be fit with random effect of year, fixed effect of year
and/or continuous effect of year (i.e., year trend). The
<code>min_random_year</code> argument dictates the minimum number of
years in the dataset required to fit a random year effect; otherwise a
fixed year effect is fit. It is not recommended to fit a random year
effect with fewer than 5 years. A continuous fixed effect of year can be
fit with <code>year_trend = TRUE</code>.</p>
<p>The user can set <code>quiet = FALSE</code> argument to see messages
and sampling progress.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recruitment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_a.html" class="external-link">bbourecruit_a</a></span>, year_start <span class="op">=</span> <span class="fl">4</span>, year_trend <span class="op">=</span> <span class="cn">TRUE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convergence">Convergence<a class="anchor" aria-label="anchor" href="#convergence"></a>
</h3>
<p>Model convergence can be checked with the <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">recruitment</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 8</span></span></span>
<span><span class="co">#&gt;       n     K nchains niters nthin   ess  rhat converged</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    27     4       3   <span style="text-decoration: underline;">1</span>000    10   993  1.00 TRUE</span></span></code></pre></div>
<p>Model convergence provides an indication of whether the parameter
estimates are reliable.</p>
<p>Convergence is considered successful if <code>ess</code> &gt; 33% of
the number of iterations and <code>rhat</code> &lt; 1.1.
<code>ess</code> (Effective Sample Size) represents the length of a
chain (i.e., number of iterations) if each sample was independent of the
one before it. <code>rhat</code> evaluates whether the chains agree on
the same values. As the total variance of all the chains shrinks to the
average variance within chains, r-hat approaches 1.</p>
<p>By default, the <code>bboutools</code> Bayesian method saves 1,000
MCMC samples from each of three chains (after discarding the first
halves). The number of samples saved can be adjusted with the
<code>niters</code> argument. With <code>niters</code> set, the user can
simply increment the thinning rate as required to achieve convergence
(i.e., by increasing <code>ess</code> and/or decreasing
<code>rhat</code>).</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>Various generic functions in <code>bboutools</code> can be used to
summarize or interrogate the output of model fitting functions.</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> and <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> provide a tidy table of
the coefficient estimates.</li>
<li>
<code><a href="https://poissonconsulting.github.io/universals/reference/estimates.html" class="external-link">estimates()</a></code> provides a list of the coefficient
estimates.</li>
<li>
<code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> provides the data used.</li>
<li>
<code><a href="../reference/model_code.html">model_code()</a></code> provides the model code in BUGS-like
syntax.</li>
<li>
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> provides traceplots for individual
parameters.</li>
</ul>
<p>The user can exclude individual random effect estimates from
coefficient output.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">recruitment</span>, include_random_effects <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   term    estimate  lower   upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;term&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> b0       -<span style="color: #BB0000;">1.46</span>   -<span style="color: #BB0000;">1.63</span>  -<span style="color: #BB0000;">1.29</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> bYear    -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.258</span>  0.069<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sAnnual   0.326   0.188  0.517</span></span></code></pre></div>
<p>Keep in mind that any reference to ‘Year’ or ‘Annual’ in these
summary outputs represent the caribou year, which can be set by the user
within the fitting functions.</p>
</div>
<div class="section level3">
<h3 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h3>
<p>In general, weakly informative priors are used by default <span class="citation">(Gelman, Simpson, and Betancourt 2017; McElreath
2016)</span>. The default prior distribution parameter values can be
accessed from <code><a href="../reference/bb_priors_recruitment.html">bb_priors_recruitment()</a></code> and
<code><a href="../reference/bb_priors_survival.html">bb_priors_survival()</a></code>. See the priors vignette for more
information.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bb_priors_recruitment.html">bb_priors_recruitment</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         b0_mu                         b0_sd </span></span>
<span><span class="co">#&gt;                            -1                             5 </span></span>
<span><span class="co">#&gt;                      bYear_mu                      bYear_sd </span></span>
<span><span class="co">#&gt;                             0                             2 </span></span>
<span><span class="co">#&gt;                    bAnnual_sd                  sAnnual_rate </span></span>
<span><span class="co">#&gt;                             5                             1 </span></span>
<span><span class="co">#&gt; adult_female_proportion_alpha  adult_female_proportion_beta </span></span>
<span><span class="co">#&gt;                            65                            35</span></span></code></pre></div>
<p>The default prior distribution for adult_female_proportion is
<code>Beta(65, 35)</code> and the default prior distribution for the
intercept (<code>b0</code>) is <code>Normal(-1.5, 1)</code>, which is on
the log scale. The user can change the priors by providing a named
vector to the <code>priors</code> argument in the model fitting
functions. The names must match one of the names in
<code><a href="../reference/bb_priors_recruitment.html">bb_priors_recruitment()</a></code>.</p>
<p>For example, less informative priors for
<code>adult_female_proportion</code> (e.g., <code>Beta(1, 1)</code>) and
<code>b0</code> (e.g., <code>Normal(0, 5)</code>) can be supplied as
follows.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recruitment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_a.html" class="external-link">bbourecruit_a</a></span>, priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>adult_female_proportion_alpha <span class="op">=</span> <span class="fl">1</span>, adult_female_proportion_beta <span class="op">=</span> <span class="fl">1</span>, b0_mu <span class="op">=</span> <span class="fl">0</span>, b0_sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If the user is interested in fitting models without any prior
information, see <code><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml()</a></code> and
<code><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml()</a></code>, which use a Maximum Likelihood
approach (see more details below).</p>
</div>
</div>
<div class="section level2">
<h2 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h2>
<p>The annual survival in boreal caribou population is typically
estimated from the monthly fates of collared adult females.
<code>bboutools</code> fits a Binomial monthly survival model to the
number of collared females and mortalities. The user can choose whether
to include individuals with uncertain fates with the certain
mortalities.</p>
<p>The function <code><a href="../reference/bb_fit_survival.html">bb_fit_survival()</a></code> fits a Bayesian survival
model.</p>
<p>The survival model is always fit with a random intercept for each
month. Otherwise, the <code>year_start</code>, <code>year_trend</code>,
and <code>min_random_year</code> arguments have the same behaviour as
<code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code> above.</p>
<p>If <code>include_uncertain_mortalities = TRUE</code>, the total
mortalities is the sum of the certain mortalities and uncertain
mortalities (‘MortalitiesCertain’ and ‘MortalitiesUncertain’ columns);
otherwise, only certain mortalities are used to fit the model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survival</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival.html">bb_fit_survival</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbousurv_a.html" class="external-link">bbousurv_a</a></span>, year_start <span class="op">=</span> <span class="fl">4</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">survival</span>, include_random_effects <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   term    estimate  lower upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;term&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> b0         4.46  4.16   4.8  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sAnnual    0.327 0.032<span style="text-decoration: underline;">5</span> 0.675</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sMonth     0.278 0.060<span style="text-decoration: underline;">8</span> 0.669</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h2>
<p>A user can generate and plot predictions of recruitment, survival and
population growth.</p>
<p>Recruitment is the adjusted recruitment using methods from <span class="citation">(DeCesare et al. 2012)</span>. See the ‘analytical
methods’ article for details.</p>
<p>Predictions of calf-cow ratio can also be made using
<code><a href="../reference/bb_predict_calf_cow_ratio.html">bb_predict_calf_cow_ratio()</a></code>.</p>
<div class="section level4">
<h4 id="recruitment-by-year">Recruitment by year<a class="anchor" aria-label="anchor" href="#recruitment-by-year"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_recruitment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_recruitment.html">bb_predict_recruitment</a></span><span class="op">(</span><span class="va">recruitment</span>, year <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bb_plot_year_recruitment.html">bb_plot_year_recruitment</a></span><span class="op">(</span><span class="va">predict_recruitment</span><span class="op">)</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="recruitment-for-a-typical-year">Recruitment for a ‘typical’ year<a class="anchor" aria-label="anchor" href="#recruitment-for-a-typical-year"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_recruitment_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_recruitment.html">bb_predict_recruitment</a></span><span class="op">(</span><span class="va">recruitment</span>, year <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">predict_recruitment_1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;   PopulationName CaribouYear Month estimate  lower  upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A                       <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   0.086<span style="text-decoration: underline;">2</span> 0.075<span style="text-decoration: underline;">8</span> 0.097<span style="text-decoration: underline;">6</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="recruitment-trend">Recruitment trend<a class="anchor" aria-label="anchor" href="#recruitment-trend"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_recruitment_trend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_recruitment_trend.html">bb_predict_recruitment_trend</a></span><span class="op">(</span><span class="va">recruitment</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bb_plot_year_trend_recruitment.html">bb_plot_year_trend_recruitment</a></span><span class="op">(</span><span class="va">predict_recruitment_trend</span><span class="op">)</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="survival-by-year-for-a-typical-month">Survival by year for a ‘typical’ month<a class="anchor" aria-label="anchor" href="#survival-by-year-for-a-typical-month"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_survival</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_survival.html">bb_predict_survival</a></span><span class="op">(</span><span class="va">survival</span>, year <span class="op">=</span> <span class="cn">TRUE</span>, month <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bb_plot_year_survival.html">bb_plot_year_survival</a></span><span class="op">(</span><span class="va">predict_survival</span><span class="op">)</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="survival-by-month-for-a-typical-year">Survival by month for a ‘typical’ year<a class="anchor" aria-label="anchor" href="#survival-by-month-for-a-typical-year"></a>
</h4>
<p>The estimates show annual survival, i.e., if that month lasted the
duration of the year.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_survival_month</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_survival.html">bb_predict_survival</a></span><span class="op">(</span><span class="va">survival</span>, year <span class="op">=</span> <span class="cn">FALSE</span>, month <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bb_plot_month_survival.html">bb_plot_month_survival</a></span><span class="op">(</span><span class="va">predict_survival_month</span><span class="op">)</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="population-growth">Population Growth<a class="anchor" aria-label="anchor" href="#population-growth"></a>
</h2>
<p>A user can predict population growth (lambda) with
<code><a href="../reference/bb_predict_growth.html">bb_predict_growth()</a></code>. The survival and recruitment models
fit in the previous steps are used as input. It is important to ensure
that survival and recruitment outputs share the same biological year
(i.e., ‘caribou year’), which is set with the <code>year_start</code>
argument in <code>bb_fir_survival()</code> and
<code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code>. Details on how lambda is calculated
can be found in the analytical methods vignette.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_growth.html">bb_predict_growth</a></span><span class="op">(</span>survival <span class="op">=</span> <span class="va">survival</span>, recruitment <span class="op">=</span> <span class="va">recruitment</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/bb_plot_year_growth.html">bb_plot_year_growth</a></span><span class="op">(</span><span class="va">predict_lambda</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">y</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>Population change (%) is calculated with uncertainty as the
cumulative product of population growth.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict_change</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_population_change.html">bb_predict_population_change</a></span><span class="op">(</span>survival <span class="op">=</span> <span class="va">survival</span>, recruitment <span class="op">=</span> <span class="va">recruitment</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bb_plot_year_population_change.html">bb_plot_year_population_change</a></span><span class="op">(</span><span class="va">predict_change</span><span class="op">)</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="maximum-likelihood">Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood"></a>
</h2>
<p>Maximum Likelihood (ML) models can be fit using the
<code><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml()</a></code> and
<code><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml()</a></code> functions. These functions take a few
seconds to execute because Nimble must compile the model into C++ code.
See the <a href="https://r-nimble.org/html_manual/cha-AD.html#how-to-use-laplace-approximation" class="external-link">Nimble
documentation</a> for more information and comparison to TMB. Similar to
Bayesian model fits, generic functions (e.g., <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>,
<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> and <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code>) work on ML fit objects
(class ‘bboufit_ml’).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recruitment_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_a.html" class="external-link">bbourecruit_a</a></span>, year_start <span class="op">=</span> <span class="fl">4</span>, year_trend <span class="op">=</span> <span class="cn">TRUE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">recruitment_ml</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;       n     K loglik converged</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    27     2  -<span style="color: #BB0000;">90.1</span> TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survival_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbousurv_a.html" class="external-link">bbousurv_a</a></span>, year_start <span class="op">=</span> <span class="fl">4</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The ML estimates are comparable to estimates derived from the
equivalent Bayesian models above. In general, ML models can be
interpreted as Bayesian models with uninformative (e.g., uniform) priors
<span class="citation">(McElreath 2016)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">recruitment_ml</span>, include_random_effects <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   term  estimate  lower   upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> b0      -<span style="color: #BB0000;">1.43</span>  -<span style="color: #BB0000;">1.53</span>  -<span style="color: #BB0000;">1.33</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> bYear   -<span style="color: #BB0000;">0.112</span> -<span style="color: #BB0000;">0.211</span> -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">8</span></span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">survival_ml</span>, include_random_effects <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   term    estimate  lower upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> b0         4.45  4.16   4.75 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sAnnual    0.335 0.102  1.1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sMonth     0.24  0.072<span style="text-decoration: underline;">8</span> 0.789</span></span></code></pre></div>
<p>There is functionality in <code>bboutools</code> to generate
predictions (i.e., derived parameters) from ML models. However, there is
no functionality to get confidence intervals on predictions. This is a
more straightforward task with Bayesian models.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bb_predict_survival.html">bb_predict_survival</a></span><span class="op">(</span><span class="va">survival_ml</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 6</span></span></span>
<span><span class="co">#&gt;    PopulationName CaribouYear Month estimate lower upper</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> A                     <span style="text-decoration: underline;">1</span>985    <span style="color: #BB0000;">NA</span>    0.873    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> A                     <span style="text-decoration: underline;">1</span>986    <span style="color: #BB0000;">NA</span>    0.883    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> A                     <span style="text-decoration: underline;">1</span>987    <span style="color: #BB0000;">NA</span>    0.83     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> A                     <span style="text-decoration: underline;">1</span>988    <span style="color: #BB0000;">NA</span>    0.89     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> A                     <span style="text-decoration: underline;">1</span>989    <span style="color: #BB0000;">NA</span>    0.875    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> A                     <span style="text-decoration: underline;">1</span>990    <span style="color: #BB0000;">NA</span>    0.871    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> A                     <span style="text-decoration: underline;">1</span>991    <span style="color: #BB0000;">NA</span>    0.878    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> A                     <span style="text-decoration: underline;">1</span>992    <span style="color: #BB0000;">NA</span>    0.891    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> A                     <span style="text-decoration: underline;">1</span>993    <span style="color: #BB0000;">NA</span>    0.868    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> A                     <span style="text-decoration: underline;">1</span>994    <span style="color: #BB0000;">NA</span>    0.842    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 22 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">growth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_predict_growth.html">bb_predict_growth</a></span><span class="op">(</span><span class="va">survival_ml</span>, <span class="va">recruitment_ml</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bb_plot_year_growth.html">bb_plot_year_growth</a></span><span class="op">(</span><span class="va">growth</span><span class="op">)</span></span></code></pre></div>
<p><img src="bboutools_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>Note that ML models can struggle to converge when there are sparse
data, especially with a fixed year effect. If these issues arise, the
user can try estimating year as a random effect, continuous effect
(<code>year_trend</code>), excluding year altogether (i.e., with
<code>exclude_year = TRUE</code>), or fitting a Bayesian model.</p>
<p>Another possible source of convergence issues is initial values. By
default, <code>bboutools</code> sets initial values based on the default
priors used for parameters in the Bayesian models. The user can replace
initial values for parameters using <code>inits</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inits_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml</a></span><span class="op">(</span><span class="fu">bboudata</span><span class="fu">::</span><span class="va"><a href="https://poissonconsulting.github.io/bboudata/reference/bbourecruit_a.html" class="external-link">bbourecruit_a</a></span>, inits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fl">1</span>, sAnnual <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="understanding-bboufit-objects">Understanding <code>bboufit</code> objects<a class="anchor" aria-label="anchor" href="#understanding-bboufit-objects"></a>
</h2>
<p>The <code><a href="../reference/bb_fit_survival.html">bb_fit_survival()</a></code> and
<code><a href="../reference/bb_fit_recruitment.html">bb_fit_recruitment()</a></code> functions use a Bayesian approach and
return objects that inherit from class <code>bboufit</code>.</p>
<p>Objects of class <code>bboufit</code> have four elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>model</code> - the compiled Nimble model as created by
<code><a href="https://rdrr.io/pkg/nimble/man/nimbleModel.html" class="external-link">nimble::nimbleModel()</a></code>.<br>
</li>
<li>
<code>model_code</code> - the model code in text format.<br>
</li>
<li>
<code>samples</code> - the MCMC samples generated
from<code><a href="https://rdrr.io/pkg/nimble/man/runMCMC.html" class="external-link">nimble::runMCMC()</a></code> converted to an object of class
<code>mcmcr</code>.<br>
</li>
<li>
<code>data</code> - the survival or recruitment data provided.</li>
</ol>
<p>These are the raw materials for any further exploration or analysis.
For example, view trace and density plots with
<code>plot(fit$samples)</code>.</p>
<p>See <a href="https://github.com/poissonconsulting/mcmcr" class="external-link">mcmcr</a>
and <a href="https://github.com/poissonconsulting/mcmcderive" class="external-link">mcmcderive</a>
for working with <code>mcmcr</code> objects, or convert samples to an
object of class <code>mcmc.list</code>, e,g, with
<code><a href="https://rdrr.io/pkg/coda/man/mcmc.list.html" class="external-link">coda::as.mcmc.list</a></code> for working with the <a href="https://github.com/cran/coda" class="external-link">coda</a> R package.</p>
<p>The <code><a href="../reference/bb_fit_survival_ml.html">bb_fit_survival_ml()</a></code> and
<code><a href="../reference/bb_fit_recruitment_ml.html">bb_fit_recruitment_ml()</a></code> functions use a Maximum Likelihood
approach and return objects that inherit from class
<code>bboufit_ml</code>.</p>
<p>Objects of class <code>bboufit_ml</code> have five elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>model</code> - the Nimble model as created by
<code><a href="https://rdrr.io/pkg/nimble/man/nimbleModel.html" class="external-link">nimble::nimbleModel()</a></code>.<br>
</li>
<li>
<code>model_code</code> - the model code in text format.<br>
</li>
<li>
<code>mle</code> - the Maximum Likelihood output as created by
model$findMLE().</li>
<li>
<code>summary</code> - the summary of the Maximum Likelihood output
as created by <code>model$summary(mle)</code>.<br>
</li>
<li>
<code>data</code> - the survival or recruitment data provided.</li>
</ol>
<p>See <a href="https://github.com/nimble-dev/nimble" class="external-link">nimble</a> for how
to work with nimble model objects and Maximum Likelihood output.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-decesare_estimating_2012" class="csl-entry">
DeCesare, Nicholas J., Mark Hebblewhite, Mark Bradley, Kirby G. Smith,
David Hervieux, and Lalenia Neufeld. 2012. <span>“Estimating Ungulate
Recruitment and Growth Rates Using Age Ratios.”</span> <em>The Journal
of Wildlife Management</em> 76 (1): 144–53. <a href="https://doi.org/10.1002/jwmg.244" class="external-link">https://doi.org/10.1002/jwmg.244</a>.
</div>
<div id="ref-gelman_prior_2017" class="csl-entry">
Gelman, Andrew, Daniel Simpson, and Michael Betancourt. 2017. <span>“The
<span>Prior</span> <span>Can</span> <span>Often</span> <span>Only</span>
<span>Be</span> <span>Understood</span> in the <span>Context</span> of
the <span>Likelihood</span>.”</span> <em>Entropy</em> 19 (10). <a href="https://doi.org/10.3390/e19100555" class="external-link">https://doi.org/10.3390/e19100555</a>.
</div>
<div id="ref-mcelreath_statistical_2016" class="csl-entry">
McElreath, Richard. 2016. <em>Statistical Rethinking: A
<span>Bayesian</span> Course with Examples in <span>R</span> and
<span>Stan</span></em>. Chapman &amp; <span>Hall</span>/<span>CRC</span>
Texts in Statistical Science Series 122. Boca Raton: CRC Press/Taylor
&amp; Francis Group.
</div>
<div id="ref-r" class="csl-entry">
R Core Team. 2023. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.
</div>
<div id="ref-smith_2004" class="csl-entry">
Smith, Kirby Gordon. 2004. <span>“Woodland <span>Caribou</span>
<span>Demography</span> and <span>Persistence</span>
<span>Relative</span> to <span>Landscape</span> <span>Change</span> in
<span>West</span>-Central <span>Alberta</span>.”</span> 125.
</div>
<div id="ref-ggplot2" class="csl-entry">
Wickham, Hadley. 2016. <em><span class="nocase">ggplot2</span>: Elegant
Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-wickham_r_2016" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science:
Import, Tidy, Transform, Visualize, and Model Data</em>. First edition.
Sebastopol, CA: O’Reilly. <a href="https://r4ds.had.co.nz" class="external-link">https://r4ds.had.co.nz</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Seb Dalgarno, Joe Thorley, John Boulanger, Ayla Pearson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
